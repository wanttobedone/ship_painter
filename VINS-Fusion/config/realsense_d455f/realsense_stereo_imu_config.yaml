%YAML:1.0

#common parameters
#support: 1 imu 1 cam; 1 imu 2 cam: 2 cam; 
imu: 1         
num_of_cam: 2  

# 这里改为 MAVROS 的话题
imu_topic: "/mavros/imu/data_raw" 
image0_topic: "/camera/infra1/image_rect_raw"
image1_topic: "/camera/infra2/image_rect_raw"
output_path: "/home/ncu/vins_output/"

# 引用之前写好的内参文件 (保持不变)
cam0_calib: "left.yaml"
cam1_calib: "right.yaml"
image_width: 640
image_height: 480

# Extrinsic parameter (Camera to IMU)
# 1 = Enable online estimation. 
# 飞控IMU，开启在线估算！
estimate_extrinsic: 1 

# Rotation from Camera Frame to IMU Frame (imu^R_cam)
# 这里的IMU指的是飞控中心 (FCU)
# 下面是一个通用的猜测值 (假设相机朝前，飞控朝前)
# 如果你的相机和飞控安装方向一致，用 Identity 矩阵即可
body_T_cam0: !!opencv-matrix
   rows: 4
   cols: 4
   dt: d
   data: [1, 0, 0, 0.1,   # 假设相机在飞控前方 10cm (x轴)
          0, 1, 0, 0,
          0, 0, 1, 0,
          0, 0, 0, 1]

body_T_cam1: !!opencv-matrix
   rows: 4
   cols: 4
   dt: d
   data: [1, 0, 0, 0.1, 
          0, 1, 0, -0.095, # 假设右目在左目右边 9.5cm
          0, 0, 1, 0,
          0, 0, 0, 1]

# IMU Parameters (Pixhawk 常用的 ICM/MPU 系列参数)
acc_n: 0.2          # accelerometer measurement noise standard deviation. 
gyr_n: 0.02         # gyroscope measurement noise standard deviation.     
acc_w: 0.0002       # accelerometer bias random work noise standard deviation.  
gyr_w: 2.0e-5       # gyroscope bias random work noise standard deviation.     
g_norm: 9.81007     # gravity magnitude

#feature traker paprameters
max_cnt: 150            # max feature number in feature tracking
min_dist: 30            # min distance between two features 
freq: 10                # frequence (Hz) of publish tracking result. At least 10Hz for good estimation. If set 0, the frequence will be same as raw image 
F_threshold: 1.0        # ransac threshold (pixel)
show_track: 0           # publish tracking image as topic
flow_back: 1            # perform forward and backward optical flow to improve feature tracking accuracy    

# Optimization Parameters
solver_time: 0.04   
num_iterations: 8   
min_parallax: 10.0  

# Time Synchronization
# 由于相机(USB)和飞控(串口)没有硬件同步线，时间戳会有几十毫秒的误差
# 必须开启在线时间同步估算
estimate_td: 1
td: 0.0   # 初始猜测 0，VINS 会自动优化这个值